import java.util.Scanner;
import usuarios.CtrDomUsr;

public class CtrPresUser {
	
	private Scanner input;
	private CtrDomUsr cu;
	
	//Opcions del menu de gestio d'usuaris
	public static final int OP_MODUS = 1;
	public static final int OP_MODPASS = 2;
	public static final int OP_BORCU = 3;
	public static final int OP_LOGOUT = 4;
	
	/*Constructor*/
	public CtrPresUser() {
		cu = new CtrDomUsr();
	}
	
	/*Modificadores|voids*/
	public void setInput(Scanner input) {
		this.input = input;
	}
	
	//Funció per loguejar un usuari
	public void login() {
		System.out.println("Login:");
		System.out.println("Escribe tu nombre de usuario:");
		String u = input.next();

		System.out.println("Escribe tu password:");
		String p = input.next();
		
		if (cu.isUser1(u, p, false)){
			System.out.println("Login correcto, por favor, seleccione una opcion");
		}
		else {
			System.out.println("Login incorrecto, por favor, vuelva a introducir sus datos:");
			login();
		}
	}
	
	//Funcio per registrar un nou usuari
	public void register() {
		System.out.println("Registro:");
		System.out.println("Escribe tu nombre de usuario:");
		String u = input.next();
		System.out.println("Escribe tu password:");
		String p = input.next();
		System.out.println("Confirma tu password:");
		String p2 = input.next();
		boolean registrat = cu.afegirUsuari(u,p);
		if(registrat){
			
		}
		else{
			System.out.println("Las password no coinciden o el nombre de usuario ya existe.");
			System.out.println("Por favor, vuelve a intentarlo:");
			register();
		}
	}
	
	//Menu de gestio d'usuaris
	public void usrs(){
		System.out.println("Gestionar Cuenta:");
		System.out.println("Escribe tu nombre de usuario:");
		String x = input.next();
		System.out.println("Escribe tu password:");
		String y = input.next();
		
		if(cu.isUser1(x,y,false)){
		
			System.out.println("Acceso correcto. Indique que quiere hacer:");
			System.out.println(OP_MODUS + ". Modificar su nombre de usuario");
			System.out.println(OP_MODPASS + ". Modificar su contraseña");
			System.out.println(OP_BORCU + ". Borrar Cuenta");
			System.out.println(OP_LOGOUT + ". Salir al menu principal");
			
			int op = input.nextInt();
			
			
			switch (op) {
			case OP_MODUS:
				System.out.println("Modificar Nombre de Usuario:");
				modUs(x,y);
				break;
				
			case OP_MODPASS:
				System.out.println("Modificar Contraseña:");
				modPass(x,y);
				break;
				
			case OP_BORCU:
				System.out.println("Borrar Cuenta:");
				borrCu();
				break;
				
			case OP_LOGOUT:
				System.out.println("Volviendo al menu de inicio...");
				break;
				
			default:
				System.out.println("Opcion incorrecta");
				break;
			}
		}
	}
	
	//Funció de modificació d'usuaris
	public void modUs(String x, String y){
		System.out.println("Escribe el nombre de usuario actual:");
		String u = input.next();
		System.out.println("Escribe su nuevo nombre:");
		String u2 = input.next();
		if (!cu.isUser1(u2,u,true) & u.equals(x)){
			cu.modUs2(u,u2);
		}else {
			System.out.println("El nombre de usuario ya existe. Por favor, vuelve a intentarlo:");
			modUs(x,y);
		}
	}
	
	//Funció de modificar Password
	public void modPass(String x, String y){
		System.out.println("Escribe el nombre de usuario actual:");
		String u = input.next();
		System.out.println("Escribe su Contraseña actual:");
		String p = input.next();
		System.out.println("Escribe su nueva Contraseña:");
		String p2 = input.next();
		
		if (cu.isUser1(u,p,false) & u.equals(x) & p.equals(y)){
			cu.modPass2(u,p2);
		}else {
			System.out.println("La Contraseña no corresponde a su Contraseña actual. Por favor, vuelve a intentarlo:");
			modPass(x,y);
		}
	}
	
	//Funció per esborrar un usuari
	public void borrCu(){
		
	}
}
